import requests
import os
import time

SERVER_URL = 'http://80.89.239.237:5000'
PC_ID = 'pc1'
PC_NAME = 'Personal Computer 1' 

def register_pc():
    response = requests.post(f'{SERVER_URL}/register', json={'pc_id': PC_ID, 'pc_name': PC_NAME})
    if response.status_code == 200:
        print(f"PC {PC_NAME} registered successfully.")
    else:
        print("Failed to register PC.")

def execute_command(command):
    if command == 'shutdown':
        os.system('shutdown /s /t 0')
    elif command == 'reboot':
        os.system('shutdown /r /t 0')
    elif command == 'sleep':
        os.system('rundll32.exe powrprof.dll,SetSuspendState 0,1,0')

def main():
    register_pc()
    while True:
        try:
            response = requests.get(f'{SERVER_URL}/get_command/{PC_ID}')
            data = response.json()
            command = data.get('command')
            if command:
                print(f"Executing command: {command}")
                execute_command(command)
        except Exception as e:
            print(f"Error fetching command: {e}")
        
        time.sleep(5)

if __name__ == '__main__':
    main()

